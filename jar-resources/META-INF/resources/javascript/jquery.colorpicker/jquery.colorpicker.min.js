
(function(e){e.colorpicker=new function(){this.regional=[];this.regional[""]={ok:"OK",cancel:"Cancel",none:"None",button:"Color",title:"Pick a color",transparent:"Transparent",hsvH:"H",hsvS:"S",hsvV:"V",rgbR:"R",rgbG:"G",rgbB:"B",labL:"L",labA:"a",labB:"b",hslH:"H",hslS:"S",hslL:"L",cmykC:"C",cmykM:"M",cmykY:"Y",cmykK:"K",alphaA:"A"}};var p=0,f='<div class="ui-colorpicker ui-colorpicker-dialog ui-dialog ui-widget ui-widget-content ui-corner-all" style="display: none;"></div>',i='<div class="ui-colorpicker ui-colorpicker-inline ui-dialog ui-widget ui-widget-content ui-corner-all"></div>',l={full:["header","map","bar","hex","hsv","rgb","alpha","lab","cmyk","preview","swatches","footer"],popup:["map","bar","hex","hsv","rgb","alpha","preview","footer"],draggable:["header","map","bar","hex","hsv","rgb","alpha","preview","footer"],inline:["map","bar","hex","hsv","rgb","alpha","preview"]},m=function(r){var q=Math.round(r).toString(16);if(q.length===1){q=("0"+q)}return q.toLowerCase()},n={"#HEX":function(q){return b("#rxgxbx",q)},"#HEX3":function(r){var q=n.HEX3(r);return q===false?false:"#"+q},HEX:function(q){return b("rxgxbx",q)},HEX3:function(s){var t=s.getRGB(),v=Math.round(t.r*255),u=Math.round(t.g*255),q=Math.round(t.b*255);if(((v>>>4)==(v&=15))&&((u>>>4)==(u&=15))&&((q>>>4)==(q&=15))){return v.toString(16)+u.toString(16)+q.toString(16)}return false},RGB:function(q){return q.getAlpha()>=1?b("rgb(rd,gd,bd)",q):false},RGBA:function(q){return b("rgba(rd,gd,bd,af)",q)},"RGB%":function(q){return q.getAlpha()>=1?b("rgb(rp%,gp%,bp%)",q):false},"RGBA%":function(q){return b("rgba(rp%,gp%,bp%,af)",q)},HSL:function(q){return q.getAlpha()>=1?b("hsl(hd,sd,vd)",q):false},HSLA:function(q){return b("hsla(hd,sd,vd,af)",q)},"HSL%":function(q){return q.getAlpha()>=1?b("hsl(hp%,sp%,vp%)",q):false},"HSLA%":function(q){return b("hsla(hp%,sp%,vp%,af)",q)},NAME:function(q){return d(q)},EXACT:function(q){return k(q)}},b=function(r,s){var u=this,v=null,t={x:function(w){return m(w*255)},d:function(w){return Math.round(w*255)},f:function(w){return w},p:function(w){return w*100}},q=s.getChannels();if(!e.isArray(r)){r=[r]}e.each(r,function(w,x){if(n[x]){v=n[x](s);return(v===false)}else{v=x.replace(/\\?[argbhsvcmykLAB][xdfp]/g,function(y){if(y.match(/^\\/)){return y.slice(1)}return t[y.charAt(1)](q[y.charAt(0)])});return false}});return v},h={black:{r:0,g:0,b:0},dimgray:{r:0.4117647058823529,g:0.4117647058823529,b:0.4117647058823529},gray:{r:0.5019607843137255,g:0.5019607843137255,b:0.5019607843137255},darkgray:{r:0.6627450980392157,g:0.6627450980392157,b:0.6627450980392157},silver:{r:0.7529411764705882,g:0.7529411764705882,b:0.7529411764705882},lightgrey:{r:0.8274509803921568,g:0.8274509803921568,b:0.8274509803921568},gainsboro:{r:0.8627450980392157,g:0.8627450980392157,b:0.8627450980392157},whitesmoke:{r:0.9607843137254902,g:0.9607843137254902,b:0.9607843137254902},white:{r:1,g:1,b:1},rosybrown:{r:0.7372549019607844,g:0.5607843137254902,b:0.5607843137254902},indianred:{r:0.803921568627451,g:0.3607843137254902,b:0.3607843137254902},brown:{r:0.6470588235294118,g:0.16470588235294117,b:0.16470588235294117},firebrick:{r:0.6980392156862745,g:0.13333333333333333,b:0.13333333333333333},lightcoral:{r:0.9411764705882353,g:0.5019607843137255,b:0.5019607843137255},maroon:{r:0.5019607843137255,g:0,b:0},darkred:{r:0.5450980392156862,g:0,b:0},red:{r:1,g:0,b:0},snow:{r:1,g:0.9803921568627451,b:0.9803921568627451},salmon:{r:0.9803921568627451,g:0.5019607843137255,b:0.4470588235294118},mistyrose:{r:1,g:0.8941176470588236,b:0.8823529411764706},tomato:{r:1,g:0.38823529411764707,b:0.2784313725490196},darksalmon:{r:0.9137254901960784,g:0.5882352941176471,b:0.47843137254901963},orangered:{r:1,g:0.27058823529411763,b:0},coral:{r:1,g:0.4980392156862745,b:0.3137254901960784},lightsalmon:{r:1,g:0.6274509803921569,b:0.47843137254901963},sienna:{r:0.6274509803921569,g:0.3215686274509804,b:0.17647058823529413},seashell:{r:1,g:0.9607843137254902,b:0.9333333333333333},chocolate:{r:0.8235294117647058,g:0.4117647058823529,b:0.11764705882352941},saddlebrown:{r:0.5450980392156862,g:0.27058823529411763,b:0.07450980392156863},sandybrown:{r:0.9568627450980393,g:0.6431372549019608,b:0.3764705882352941},peachpuff:{r:1,g:0.8549019607843137,b:0.7254901960784313},peru:{r:0.803921568627451,g:0.5215686274509804,b:0.24705882352941178},linen:{r:0.9803921568627451,g:0.9411764705882353,b:0.9019607843137255},darkorange:{r:1,g:0.5490196078431373,b:0},bisque:{r:1,g:0.8941176470588236,b:0.7686274509803922},burlywood:{r:0.8705882352941177,g:0.7215686274509804,b:0.5294117647058824},tan:{r:0.8235294117647058,g:0.7058823529411765,b:0.5490196078431373},antiquewhite:{r:0.9803921568627451,g:0.9215686274509803,b:0.8431372549019608},navajowhite:{r:1,g:0.8705882352941177,b:0.6784313725490196},blanchedalmond:{r:1,g:0.9215686274509803,b:0.803921568627451},papayawhip:{r:1,g:0.9372549019607843,b:0.8352941176470589},orange:{r:1,g:0.6470588235294118,b:0},moccasin:{r:1,g:0.8941176470588236,b:0.7098039215686275},wheat:{r:0.9607843137254902,g:0.8705882352941177,b:0.7019607843137254},oldlace:{r:0.9921568627450981,g:0.9607843137254902,b:0.9019607843137255},floralwhite:{r:1,g:0.9803921568627451,b:0.9411764705882353},goldenrod:{r:0.8549019607843137,g:0.6470588235294118,b:0.12549019607843137},darkgoldenrod:{r:0.7215686274509804,g:0.5254901960784314,b:0.043137254901960784},cornsilk:{r:1,g:0.9725490196078431,b:0.8627450980392157},gold:{r:1,g:0.8431372549019608,b:0},palegoldenrod:{r:0.9333333333333333,g:0.9098039215686274,b:0.6666666666666666},khaki:{r:0.9411764705882353,g:0.9019607843137255,b:0.5490196078431373},lemonchiffon:{r:1,g:0.9803921568627451,b:0.803921568627451},darkkhaki:{r:0.7411764705882353,g:0.7176470588235294,b:0.4196078431372549},beige:{r:0.9607843137254902,g:0.9607843137254902,b:0.8627450980392157},lightgoldenrodyellow:{r:0.9803921568627451,g:0.9803921568627451,b:0.8235294117647058},olive:{r:0.5019607843137255,g:0.5019607843137255,b:0},yellow:{r:1,g:1,b:0},lightyellow:{r:1,g:1,b:0.8784313725490196},ivory:{r:1,g:1,b:0.9411764705882353},olivedrab:{r:0.4196078431372549,g:0.5568627450980392,b:0.13725490196078433},yellowgreen:{r:0.6039215686274509,g:0.803921568627451,b:0.19607843137254902},darkolivegreen:{r:0.3333333333333333,g:0.4196078431372549,b:0.1843137254901961},greenyellow:{r:0.6784313725490196,g:1,b:0.1843137254901961},lawngreen:{r:0.48627450980392156,g:0.9882352941176471,b:0},chartreuse:{r:0.4980392156862745,g:1,b:0},darkseagreen:{r:0.5607843137254902,g:0.7372549019607844,b:0.5607843137254902},forestgreen:{r:0.13333333333333333,g:0.5450980392156862,b:0.13333333333333333},limegreen:{r:0.19607843137254902,g:0.803921568627451,b:0.19607843137254902},lightgreen:{r:0.5647058823529412,g:0.9333333333333333,b:0.5647058823529412},palegreen:{r:0.596078431372549,g:0.984313725490196,b:0.596078431372549},darkgreen:{r:0,g:0.39215686274509803,b:0},green:{r:0,g:0.5019607843137255,b:0},lime:{r:0,g:1,b:0},honeydew:{r:0.9411764705882353,g:1,b:0.9411764705882353},mediumseagreen:{r:0.23529411764705882,g:0.7019607843137254,b:0.44313725490196076},seagreen:{r:0.1803921568627451,g:0.5450980392156862,b:0.3411764705882353},springgreen:{r:0,g:1,b:0.4980392156862745},mintcream:{r:0.9607843137254902,g:1,b:0.9803921568627451},mediumspringgreen:{r:0,g:0.9803921568627451,b:0.6039215686274509},mediumaquamarine:{r:0.4,g:0.803921568627451,b:0.6666666666666666},aquamarine:{r:0.4980392156862745,g:1,b:0.8313725490196079},turquoise:{r:0.25098039215686274,g:0.8784313725490196,b:0.8156862745098039},lightseagreen:{r:0.12549019607843137,g:0.6980392156862745,b:0.6666666666666666},mediumturquoise:{r:0.2823529411764706,g:0.8196078431372549,b:0.8},darkslategray:{r:0.1843137254901961,g:0.30980392156862746,b:0.30980392156862746},paleturquoise:{r:0.6862745098039216,g:0.9333333333333333,b:0.9333333333333333},teal:{r:0,g:0.5019607843137255,b:0.5019607843137255},darkcyan:{r:0,g:0.5450980392156862,b:0.5450980392156862},darkturquoise:{r:0,g:0.807843137254902,b:0.8196078431372549},aqua:{r:0,g:1,b:1},cyan:{r:0,g:1,b:1},lightcyan:{r:0.8784313725490196,g:1,b:1},azure:{r:0.9411764705882353,g:1,b:1},cadetblue:{r:0.37254901960784315,g:0.6196078431372549,b:0.6274509803921569},powderblue:{r:0.6901960784313725,g:0.8784313725490196,b:0.9019607843137255},lightblue:{r:0.6784313725490196,g:0.8470588235294118,b:0.9019607843137255},deepskyblue:{r:0,g:0.7490196078431373,b:1},skyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9215686274509803},lightskyblue:{r:0.5294117647058824,g:0.807843137254902,b:0.9803921568627451},steelblue:{r:0.27450980392156865,g:0.5098039215686274,b:0.7058823529411765},aliceblue:{r:0.9411764705882353,g:0.9725490196078431,b:1},dodgerblue:{r:0.11764705882352941,g:0.5647058823529412,b:1},slategray:{r:0.4392156862745098,g:0.5019607843137255,b:0.5647058823529412},lightslategray:{r:0.4666666666666667,g:0.5333333333333333,b:0.6},lightsteelblue:{r:0.6901960784313725,g:0.7686274509803922,b:0.8705882352941177},cornflowerblue:{r:0.39215686274509803,g:0.5843137254901961,b:0.9294117647058824},royalblue:{r:0.2549019607843137,g:0.4117647058823529,b:0.8823529411764706},midnightblue:{r:0.09803921568627451,g:0.09803921568627451,b:0.4392156862745098},lavender:{r:0.9019607843137255,g:0.9019607843137255,b:0.9803921568627451},navy:{r:0,g:0,b:0.5019607843137255},darkblue:{r:0,g:0,b:0.5450980392156862},mediumblue:{r:0,g:0,b:0.803921568627451},blue:{r:0,g:0,b:1},ghostwhite:{r:0.9725490196078431,g:0.9725490196078431,b:1},darkslateblue:{r:0.2823529411764706,g:0.23921568627450981,b:0.5450980392156862},slateblue:{r:0.41568627450980394,g:0.35294117647058826,b:0.803921568627451},mediumslateblue:{r:0.4823529411764706,g:0.40784313725490196,b:0.9333333333333333},mediumpurple:{r:0.5764705882352941,g:0.4392156862745098,b:0.8588235294117647},blueviolet:{r:0.5411764705882353,g:0.16862745098039217,b:0.8862745098039215},indigo:{r:0.29411764705882354,g:0,b:0.5098039215686274},darkorchid:{r:0.6,g:0.19607843137254902,b:0.8},darkviolet:{r:0.5803921568627451,g:0,b:0.8274509803921568},mediumorchid:{r:0.7294117647058823,g:0.3333333333333333,b:0.8274509803921568},thistle:{r:0.8470588235294118,g:0.7490196078431373,b:0.8470588235294118},plum:{r:0.8666666666666667,g:0.6274509803921569,b:0.8666666666666667},violet:{r:0.9333333333333333,g:0.5098039215686274,b:0.9333333333333333},purple:{r:0.5019607843137255,g:0,b:0.5019607843137255},darkmagenta:{r:0.5450980392156862,g:0,b:0.5450980392156862},magenta:{r:1,g:0,b:1},fuchsia:{r:1,g:0,b:1},orchid:{r:0.8549019607843137,g:0.4392156862745098,b:0.8392156862745098},mediumvioletred:{r:0.7803921568627451,g:0.08235294117647059,b:0.5215686274509804},deeppink:{r:1,g:0.0784313725490196,b:0.5764705882352941},hotpink:{r:1,g:0.4117647058823529,b:0.7058823529411765},palevioletred:{r:0.8588235294117647,g:0.4392156862745098,b:0.5764705882352941},lavenderblush:{r:1,g:0.9411764705882353,b:0.9607843137254902},crimson:{r:0.8627450980392157,g:0.0784313725490196,b:0.23529411764705882},pink:{r:1,g:0.7529411764705882,b:0.796078431372549},lightpink:{r:1,g:0.7137254901960784,b:0.7568627450980392}},k=function(q){var r=false;e.each(h,function(t,s){if(q.equals(new a(s.r,s.g,s.b))){r=t;return false}});return r},d=function(q){var s=q.getRGB(),u=null,r=false,t;e.each(h,function(w,v){t=q.distance(new a(v.r,v.g,v.b));if(t<u||u===null){r=w;if(t==0){return false}u=t}});return r},g=function(r){var s,q;q=/^#?([a-fA-F0-9]{1,6})$/.exec(r);if(q){s=parseInt(q[1],16);return new a(((s>>16)&255)/255,((s>>8)&255)/255,(s&255)/255)}return false},c=function(r){var s=e.trim(r).toLowerCase(),q;if(r==""){return new a()}if(h[s]){return new a(h[s].r,h[s].g,h[s].b)}q=/^rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(r);if(q){return new a(q[1]/255,q[2]/255,q[3]/255,parseFloat(q[4]))}q=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(r);if(q){return(new a()).setHSL(q[1]/255,q[2]/255,q[3]/255).setAlpha(parseFloat(q[4]))}q=/^rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(r);if(q){return new a(q[1]/100,q[2]/100,q[3]/100,q[4]/100)}q=/^hsla?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d+(?:\.\d+)?)\s*)?\)$/.exec(r);if(q){return(new a()).setHSL(q[1]/100,q[2]/100,q[3]/100).setAlpha(q[4]/100)}q=/^#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})$/.exec(r);if(q){return new a(parseInt(q[1],16)/255,parseInt(q[2],16)/255,parseInt(q[3],16)/255)}q=/^#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])$/.exec(r);if(q){return new a(parseInt(q[1]+q[1],16)/255,parseInt(q[2]+q[2],16)/255,parseInt(q[3]+q[3],16)/255)}return g(r)},o=function(v,G){var C,D,B,q,H,s,I,z,F,u,E,t,r,A;v.sort(function(x,w){if(x.pos[1]==w.pos[1]){return x.pos[0]-w.pos[0]}return x.pos[1]-w.pos[1]});q=0;H=0;e.each(v,function(x,w){q=Math.max(q,w.pos[0]+w.pos[2]);H=Math.max(H,w.pos[1]+w.pos[3])});C=[];for(D=0;D<q;++D){C.push([])}I=[];s=[];e.each(v,function(x,w){for(D=0;D<w.pos[2];D+=1){s[w.pos[0]+D]=true}for(B=0;B<w.pos[3];B+=1){I[w.pos[1]+B]=true}});u="";F=v[z=0];for(B=0;B<H;++B){u+="<tr>";for(D=0;D<q;D){if(typeof F!=="undefined"&&D==F.pos[0]&&B==F.pos[1]){u+=G(F,D,B);for(t=0;t<F.pos[3];t+=1){for(E=0;E<F.pos[2];E+=1){C[D+E][B+t]=true}}D+=F.pos[2];F=v[++z]}else{r=0;A=false;while(D<q&&C[D][B]===undefined&&(F===undefined||B<F.pos[1]||(B==F.pos[1]&&D<F.pos[0]))){if(s[D]===true){r+=1}A=true;D+=1}if(r>0){u+='<td colspan="'+r+'"></td>'}else{if(!A){D+=1}}}}u+="</tr>"}return'<table cellspacing="0" cellpadding="0" border="0"><tbody>'+u+"</tbody></table>"},j={header:function(s){var r=this,t=null,q=function(){var v=s.options.title||s._getRegional("title"),u='<span class="ui-dialog-title">'+v+"</span>";if(!s.inline&&s.options.showCloseButton){u+='<a href="#" class="ui-dialog-titlebar-close ui-corner-all" role="button"><span class="ui-icon ui-icon-closethick">close</span></a>'}return'<div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix">'+u+"</div>"};this.init=function(){t=e(q()).prependTo(s.dialog);var u=e(".ui-dialog-titlebar-close",t);s._hoverable(u);s._focusable(u);u.click(function(v){v.preventDefault();s.close()});if(!s.inline&&s.options.draggable){s.dialog.draggable({handle:t})}}},map:function(w){var u=this,x=null,v=null,r,t,s,q;r=function(C){if(!w.opened){return}var F=e(".ui-colorpicker-map-layer-pointer",x),D=F.offset(),B=F.width(),A=F.height(),z=C.pageX-D.left,E=C.pageY-D.top;if(z>=0&&z<B&&E>=0&&E<A){C.stopImmediatePropagation();C.preventDefault();x.unbind("mousedown",r);e(document).bind("mouseup",t);e(document).bind("mousemove",s);s(C)}};t=function(y){y.stopImmediatePropagation();y.preventDefault();e(document).unbind("mouseup",t);e(document).unbind("mousemove",s);x.bind("mousedown",r)};s=function(C){C.stopImmediatePropagation();C.preventDefault();if(C.pageX===u.x&&C.pageY===u.y){return}u.x=C.pageX;u.y=C.pageY;var F=e(".ui-colorpicker-map-layer-pointer",x),D=F.offset(),B=F.width(),A=F.height(),z=C.pageX-D.left,E=C.pageY-D.top;z=Math.max(0,Math.min(z/B,1));E=Math.max(0,Math.min(E/A,1));switch(w.mode){case"h":w.color.setHSV(null,z,1-E);break;case"s":case"a":w.color.setHSV(z,null,1-E);break;case"v":w.color.setHSV(z,1-E,null);break;case"r":w.color.setRGB(null,1-E,z);break;case"g":w.color.setRGB(1-E,null,z);break;case"b":w.color.setRGB(z,1-E,null);break}w._change()};q=function(){var y='<div class="ui-colorpicker-map ui-colorpicker-border"><span class="ui-colorpicker-map-layer-1">&nbsp;</span><span class="ui-colorpicker-map-layer-2">&nbsp;</span>'+(w.options.alpha?'<span class="ui-colorpicker-map-layer-alpha">&nbsp;</span>':"")+'<span class="ui-colorpicker-map-layer-pointer"><span class="ui-colorpicker-map-pointer"></span></span></div>';return y};this.update=function(){switch(w.mode){case"h":e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 0",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).hide();break;case"s":case"a":e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 -260px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).css({"background-position":"0 -520px",opacity:""}).show();break;case"v":e(x).css("background-color","black");e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 -780px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).hide();break;case"r":e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 -1040px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).css({"background-position":"0 -1300px",opacity:""}).show();break;case"g":e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 -1560px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).css({"background-position":"0 -1820px",opacity:""}).show();break;case"b":e(".ui-colorpicker-map-layer-1",x).css({"background-position":"0 -2080px",opacity:""}).show();e(".ui-colorpicker-map-layer-2",x).css({"background-position":"0 -2340px",opacity:""}).show();break}u.repaint()};this.repaint=function(){var B=e(".ui-colorpicker-map-layer-pointer",x),z=0,A=0;switch(w.mode){case"h":z=w.color.getHSV().s*B.width();A=(1-w.color.getHSV().v)*B.width();e(x).css("background-color",w.color.copy().normalize().toCSS());break;case"s":case"a":z=w.color.getHSV().h*B.width();A=(1-w.color.getHSV().v)*B.width();e(".ui-colorpicker-map-layer-2",x).css("opacity",1-w.color.getHSV().s);break;case"v":z=w.color.getHSV().h*B.width();A=(1-w.color.getHSV().s)*B.width();e(".ui-colorpicker-map-layer-1",x).css("opacity",w.color.getHSV().v);break;case"r":z=w.color.getRGB().b*B.width();A=(1-w.color.getRGB().g)*B.width();e(".ui-colorpicker-map-layer-2",x).css("opacity",w.color.getRGB().r);break;case"g":z=w.color.getRGB().b*B.width();A=(1-w.color.getRGB().r)*B.width();e(".ui-colorpicker-map-layer-2",x).css("opacity",w.color.getRGB().g);break;case"b":z=w.color.getRGB().r*B.width();A=(1-w.color.getRGB().g)*B.width();e(".ui-colorpicker-map-layer-2",x).css("opacity",w.color.getRGB().b);break}if(w.options.alpha){e(".ui-colorpicker-map-layer-alpha",x).css("opacity",1-w.color.getAlpha())}e(".ui-colorpicker-map-pointer",x).css({left:z-7,top:A-7})};this.init=function(){x=e(q()).appendTo(e(".ui-colorpicker-map-container",w.dialog));x.bind("mousedown",r)}},bar:function(v){var u=this,w=null,r,t,s,q;r=function(C){if(!v.opened){return}var F=e(".ui-colorpicker-bar-layer-pointer",w),D=F.offset(),B=F.width(),A=F.height(),z=C.pageX-D.left,E=C.pageY-D.top;if(z>=0&&z<B&&E>=0&&E<A){C.stopImmediatePropagation();C.preventDefault();w.unbind("mousedown",r);e(document).bind("mouseup",t);e(document).bind("mousemove",s);s(C)}};t=function(x){x.stopImmediatePropagation();x.preventDefault();e(document).unbind("mouseup",t);e(document).unbind("mousemove",s);w.bind("mousedown",r)};s=function(z){z.stopImmediatePropagation();z.preventDefault();if(z.pageY===u.y){return}u.y=z.pageY;var C=e(".ui-colorpicker-bar-layer-pointer",w),A=C.offset(),x=C.height(),B=z.pageY-A.top;B=Math.max(0,Math.min(B/x,1));switch(v.mode){case"h":v.color.setHSV(1-B,null,null);break;case"s":v.color.setHSV(null,1-B,null);break;case"v":v.color.setHSV(null,null,1-B);break;case"r":v.color.setRGB(1-B,null,null);break;case"g":v.color.setRGB(null,1-B,null);break;case"b":v.color.setRGB(null,null,1-B);break;case"a":v.color.setAlpha(1-B);break}v._change()};q=function(){var x='<div class="ui-colorpicker-bar ui-colorpicker-border"><span class="ui-colorpicker-bar-layer-1">&nbsp;</span><span class="ui-colorpicker-bar-layer-2">&nbsp;</span><span class="ui-colorpicker-bar-layer-3">&nbsp;</span><span class="ui-colorpicker-bar-layer-4">&nbsp;</span>';if(v.options.alpha){x+='<span class="ui-colorpicker-bar-layer-alpha">&nbsp;</span><span class="ui-colorpicker-bar-layer-alphabar">&nbsp;</span>'}x+='<span class="ui-colorpicker-bar-layer-pointer"><span class="ui-colorpicker-bar-pointer"></span></span></div>';return x};this.update=function(){switch(v.mode){case"h":case"s":case"v":case"r":case"g":case"b":e(".ui-colorpicker-bar-layer-alpha",w).show();e(".ui-colorpicker-bar-layer-alphabar",w).hide();break;case"a":e(".ui-colorpicker-bar-layer-alpha",w).hide();e(".ui-colorpicker-bar-layer-alphabar",w).show();break}switch(v.mode){case"h":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 0",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).hide();e(".ui-colorpicker-bar-layer-3",w).hide();e(".ui-colorpicker-bar-layer-4",w).hide();break;case"s":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 -260px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).css({"background-position":"0 -520px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",w).hide();e(".ui-colorpicker-bar-layer-4",w).hide();break;case"v":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 -520px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).hide();e(".ui-colorpicker-bar-layer-3",w).hide();e(".ui-colorpicker-bar-layer-4",w).hide();break;case"r":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 -1560px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).css({"background-position":"0 -1300px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",w).css({"background-position":"0 -780px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",w).css({"background-position":"0 -1040px",opacity:""}).show();break;case"g":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 -2600px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).css({"background-position":"0 -2340px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",w).css({"background-position":"0 -1820px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",w).css({"background-position":"0 -2080px",opacity:""}).show();break;case"b":e(".ui-colorpicker-bar-layer-1",w).css({"background-position":"0 -3640px",opacity:""}).show();e(".ui-colorpicker-bar-layer-2",w).css({"background-position":"0 -3380px",opacity:""}).show();e(".ui-colorpicker-bar-layer-3",w).css({"background-position":"0 -2860px",opacity:""}).show();e(".ui-colorpicker-bar-layer-4",w).css({"background-position":"0 -3120px",opacity:""}).show();break;case"a":e(".ui-colorpicker-bar-layer-1",w).hide();e(".ui-colorpicker-bar-layer-2",w).hide();e(".ui-colorpicker-bar-layer-3",w).hide();e(".ui-colorpicker-bar-layer-4",w).hide();break}u.repaint()};this.repaint=function(){var z=e(".ui-colorpicker-bar-layer-pointer",w),x=0;switch(v.mode){case"h":x=(1-v.color.getHSV().h)*z.height();break;case"s":x=(1-v.color.getHSV().s)*z.height();e(".ui-colorpicker-bar-layer-2",w).css("opacity",1-v.color.getHSV().v);e(w).css("background-color",v.color.copy().normalize().toCSS());break;case"v":x=(1-v.color.getHSV().v)*z.height();e(w).css("background-color",v.color.copy().normalize().toCSS());break;case"r":x=(1-v.color.getRGB().r)*z.height();e(".ui-colorpicker-bar-layer-2",w).css("opacity",Math.max(0,(v.color.getRGB().b-v.color.getRGB().g)));e(".ui-colorpicker-bar-layer-3",w).css("opacity",Math.max(0,(v.color.getRGB().g-v.color.getRGB().b)));e(".ui-colorpicker-bar-layer-4",w).css("opacity",Math.min(v.color.getRGB().b,v.color.getRGB().g));break;case"g":x=(1-v.color.getRGB().g)*z.height();e(".ui-colorpicker-bar-layer-2",w).css("opacity",Math.max(0,(v.color.getRGB().b-v.color.getRGB().r)));e(".ui-colorpicker-bar-layer-3",w).css("opacity",Math.max(0,(v.color.getRGB().r-v.color.getRGB().b)));e(".ui-colorpicker-bar-layer-4",w).css("opacity",Math.min(v.color.getRGB().r,v.color.getRGB().b));break;case"b":x=(1-v.color.getRGB().b)*z.height();e(".ui-colorpicker-bar-layer-2",w).css("opacity",Math.max(0,(v.color.getRGB().r-v.color.getRGB().g)));e(".ui-colorpicker-bar-layer-3",w).css("opacity",Math.max(0,(v.color.getRGB().g-v.color.getRGB().r)));e(".ui-colorpicker-bar-layer-4",w).css("opacity",Math.min(v.color.getRGB().r,v.color.getRGB().g));break;case"a":x=(1-v.color.getAlpha())*z.height();e(w).css("background-color",v.color.copy().normalize().toCSS());break}if(v.mode!=="a"){e(".ui-colorpicker-bar-layer-alpha",w).css("opacity",1-v.color.getAlpha())}e(".ui-colorpicker-bar-pointer",w).css("top",x-3)};this.init=function(){w=e(q()).appendTo(e(".ui-colorpicker-bar-container",v.dialog));w.bind("mousedown",r)}},preview:function(s){var r=this,t=null,q;q=function(){return'<div class="ui-colorpicker-preview ui-colorpicker-border"><div class="ui-colorpicker-preview-initial"><div class="ui-colorpicker-preview-initial-alpha"></div></div><div class="ui-colorpicker-preview-current"><div class="ui-colorpicker-preview-current-alpha"></div></div></div>'};this.init=function(){t=e(q()).appendTo(e(".ui-colorpicker-preview-container",s.dialog));e(".ui-colorpicker-preview-initial",t).click(function(){s.color=s.currentColor.copy();s._change()})};this.update=function(){if(s.options.alpha){e(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",t).show()}else{e(".ui-colorpicker-preview-initial-alpha, .ui-colorpicker-preview-current-alpha",t).hide()}this.repaint()};this.repaint=function(){e(".ui-colorpicker-preview-initial",t).css("background-color",s.currentColor.toCSS()).attr("title",s.currentColor.toHex());e(".ui-colorpicker-preview-initial-alpha",t).css("opacity",1-s.currentColor.getAlpha());e(".ui-colorpicker-preview-current",t).css("background-color",s.color.toCSS()).attr("title",s.color.toHex());e(".ui-colorpicker-preview-current-alpha",t).css("opacity",1-s.color.getAlpha())}},hsv:function(s){var r=this,t=null,q;q=function(){var u="";if(s.options.hsv){u+='<div class="ui-colorpicker-hsv-h"><input class="ui-colorpicker-mode" type="radio" value="h"/><label>'+s._getRegional("hsvH")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="360" size="10"/><span class="ui-colorpicker-unit">&deg;</span></div><div class="ui-colorpicker-hsv-s"><input class="ui-colorpicker-mode" type="radio" value="s"/><label>'+s._getRegional("hsvS")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-hsv-v"><input class="ui-colorpicker-mode" type="radio" value="v"/><label>'+s._getRegional("hsvV")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100" size="10"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-hsv">'+u+"</div>"};this.init=function(){t=e(q()).appendTo(e(".ui-colorpicker-hsv-container",s.dialog));e(".ui-colorpicker-mode",t).click(function(){s.mode=e(this).val();s._updateAllParts()});e(".ui-colorpicker-number",t).bind("change keyup",function(){s.color.setHSV(e(".ui-colorpicker-hsv-h .ui-colorpicker-number",t).val()/360,e(".ui-colorpicker-hsv-s .ui-colorpicker-number",t).val()/100,e(".ui-colorpicker-hsv-v .ui-colorpicker-number",t).val()/100);s._change()})};this.repaint=function(){var u=s.color.getHSV();u.h*=360;u.s*=100;u.v*=100;e.each(u,function(w,x){var v=e(".ui-colorpicker-hsv-"+w+" .ui-colorpicker-number",t);x=Math.round(x);if(v.val()!==x){v.val(x)}})};this.update=function(){e(".ui-colorpicker-mode",t).each(function(){e(this).attr("checked",e(this).val()===s.mode)});this.repaint()}},rgb:function(s){var r=this,t=null,q;q=function(){var u="";if(s.options.rgb){u+='<div class="ui-colorpicker-rgb-r"><input class="ui-colorpicker-mode" type="radio" value="r"/><label>'+s._getRegional("rgbR")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-g"><input class="ui-colorpicker-mode" type="radio" value="g"/><label>'+s._getRegional("rgbG")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div><div class="ui-colorpicker-rgb-b"><input class="ui-colorpicker-mode" type="radio" value="b"/><label>'+s._getRegional("rgbB")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="255"/></div>'}return'<div class="ui-colorpicker-rgb">'+u+"</div>"};this.init=function(){t=e(q()).appendTo(e(".ui-colorpicker-rgb-container",s.dialog));e(".ui-colorpicker-mode",t).click(function(){s.mode=e(this).val();s._updateAllParts()});e(".ui-colorpicker-number",t).bind("change keyup",function(){s.color.setRGB(e(".ui-colorpicker-rgb-r .ui-colorpicker-number",t).val()/255,e(".ui-colorpicker-rgb-g .ui-colorpicker-number",t).val()/255,e(".ui-colorpicker-rgb-b .ui-colorpicker-number",t).val()/255);s._change()})};this.repaint=function(){e.each(s.color.getRGB(),function(v,w){var u=e(".ui-colorpicker-rgb-"+v+" .ui-colorpicker-number",t);w=Math.round(w*255);if(u.val()!==w){u.val(w)}})};this.update=function(){e(".ui-colorpicker-mode",t).each(function(){e(this).attr("checked",e(this).val()===s.mode)});this.repaint()}},lab:function(t){var s=this,q=null,r=function(){var u="";if(t.options.hsv){u+='<div class="ui-colorpicker-lab-l"><label>'+t._getRegional("labL")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/></div><div class="ui-colorpicker-lab-a"><label>'+t._getRegional("labA")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div><div class="ui-colorpicker-lab-b"><label>'+t._getRegional("labB")+'</label><input class="ui-colorpicker-number" type="number" min="-128" max="127"/></div>'}return'<div class="ui-colorpicker-lab">'+u+"</div>"};this.init=function(){var u=0;q=e(r()).appendTo(e(".ui-colorpicker-lab-container",t.dialog));e(".ui-colorpicker-number",q).on("change keyup",function(v){t.color.setLAB(parseInt(e(".ui-colorpicker-lab-l .ui-colorpicker-number",q).val(),10)/100,(parseInt(e(".ui-colorpicker-lab-a .ui-colorpicker-number",q).val(),10)+128)/255,(parseInt(e(".ui-colorpicker-lab-b .ui-colorpicker-number",q).val(),10)+128)/255);t._change()})};this.repaint=function(){var u=t.color.getLAB();u.l*=100;u.a=(u.a*255)-128;u.b=(u.b*255)-128;e.each(u,function(w,x){var v=e(".ui-colorpicker-lab-"+w+" .ui-colorpicker-number",q);x=Math.round(x);if(v.val()!==x){v.val(x)}})};this.update=function(){this.repaint()}},cmyk:function(t){var s=this,q=null,r=function(){var u="";if(t.options.hsv){u+='<div class="ui-colorpicker-cmyk-c"><label>'+t._getRegional("cmykC")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-m"><label>'+t._getRegional("cmykM")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-y"><label>'+t._getRegional("cmykY")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div><div class="ui-colorpicker-cmyk-k"><label>'+t._getRegional("cmykK")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-cmyk">'+u+"</div>"};this.init=function(){q=e(r()).appendTo(e(".ui-colorpicker-cmyk-container",t.dialog));e(".ui-colorpicker-number",q).on("change keyup",function(u){t.color.setCMYK(parseInt(e(".ui-colorpicker-cmyk-c .ui-colorpicker-number",q).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-m .ui-colorpicker-number",q).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-y .ui-colorpicker-number",q).val(),10)/100,parseInt(e(".ui-colorpicker-cmyk-k .ui-colorpicker-number",q).val(),10)/100);t._change()})};this.repaint=function(){e.each(t.color.getCMYK(),function(v,w){var u=e(".ui-colorpicker-cmyk-"+v+" .ui-colorpicker-number",q);w=Math.round(w*100);if(u.val()!==w){u.val(w)}})};this.update=function(){this.repaint()}},alpha:function(s){var r=this,t=null,q;q=function(){var u="";if(s.options.alpha){u+='<div class="ui-colorpicker-a"><input class="ui-colorpicker-mode" name="mode" type="radio" value="a"/><label>'+s._getRegional("alphaA")+'</label><input class="ui-colorpicker-number" type="number" min="0" max="100"/><span class="ui-colorpicker-unit">%</span></div>'}return'<div class="ui-colorpicker-alpha">'+u+"</div>"};this.init=function(){t=e(q()).appendTo(e(".ui-colorpicker-alpha-container",s.dialog));e(".ui-colorpicker-mode",t).click(function(){s.mode=e(this).val();s._updateAllParts()});e(".ui-colorpicker-number",t).bind("change keyup",function(){s.color.setAlpha(e(".ui-colorpicker-a .ui-colorpicker-number",t).val()/100);s._change()})};this.update=function(){e(".ui-colorpicker-mode",t).each(function(){e(this).attr("checked",e(this).val()===s.mode)});this.repaint()};this.repaint=function(){var u=e(".ui-colorpicker-a .ui-colorpicker-number",t),v=Math.round(s.color.getAlpha()*100);if(!u.is(":focus")&&u.val()!==v){u.val(v)}}},hex:function(s){var r=this,t=null,q;q=function(){var u="";if(s.options.alpha){u+='<input class="ui-colorpicker-hex-alpha" type="text" maxlength="2" size="2"/>'}u+='<input class="ui-colorpicker-hex-input" type="text" maxlength="6" size="6"/>';return'<div class="ui-colorpicker-hex"><label>#</label>'+u+"</div>"};this.init=function(){t=e(q()).appendTo(e(".ui-colorpicker-hex-container",s.dialog));e(".ui-colorpicker-hex-input",t).bind("change keydown keyup",function(v,u,w){if(/[^a-fA-F0-9]/.test(e(this).val())){e(this).val(e(this).val().replace(/[^a-fA-F0-9]/,""))}});e(".ui-colorpicker-hex-input",t).bind("change keyup",function(){s.color=g(e(this).val()).setAlpha(s.color.getAlpha());s._change()});e(".ui-colorpicker-hex-alpha",t).bind("change keydown keyup",function(){if(/[^a-fA-F0-9]/.test(e(this).val())){e(this).val(e(this).val().replace(/[^a-fA-F0-9]/,""))}});e(".ui-colorpicker-hex-alpha",t).bind("change keyup",function(){s.color.setAlpha(parseInt(e(".ui-colorpicker-hex-alpha",t).val(),16)/255);s._change()})};this.update=function(){this.repaint()};this.repaint=function(){if(!e(".ui-colorpicker-hex-input",t).is(":focus")){e(".ui-colorpicker-hex-input",t).val(s.color.toHex(true))}if(!e(".ui-colorpicker-hex-alpha",t).is(":focus")){e(".ui-colorpicker-hex-alpha",t).val(m(s.color.getAlpha()*255))}}},swatches:function(t){var s=this,q=null,r=function(){var u="";e.each(t.options.swatches,function(w,v){var y=new a(v.r,v.g,v.b),x=y.toCSS();u+='<div class="ui-colorpicker-swatch" style="background-color: '+x+'" title="'+w+'"></div>'});return'<div class="ui-colorpicker-swatches ui-colorpicker-border">'+u+"</div>"};this.init=function(){q=e(r()).appendTo(e(".ui-colorpicker-swatches-container",t.dialog));e(".ui-colorpicker-swatch",q).click(function(){t.color=c(e(this).css("background-color"));t._change()})}},footer:function(v){var u=this,s=null,q="ui-colorpicker-special-transparent-"+p,r="ui-colorpicker-special-none-"+p,t=function(){var w="";if(v.options.alpha||(!v.inline&&v.options.showNoneButton)){w+='<div class="ui-colorpicker-buttonset">';if(v.options.alpha){w+='<input type="radio" name="ui-colorpicker-special" id="'+q+'" class="ui-colorpicker-special-transparent"/><label for="'+q+'">'+v._getRegional("transparent")+"</label>"}if(!v.inline&&v.options.showNoneButton){w+='<input type="radio" name="ui-colorpicker-special" id="'+r+'" class="ui-colorpicker-special-none"><label for="'+r+'">'+v._getRegional("none")+"</label>"}w+="</div>"}if(!v.inline){w+='<div class="ui-dialog-buttonset">';if(v.options.showCancelButton){w+='<button class="ui-colorpicker-cancel">'+v._getRegional("cancel")+"</button>"}w+='<button class="ui-colorpicker-ok">'+v._getRegional("ok")+"</button>";w+="</div>"}return'<div class="ui-dialog-buttonpane ui-widget-content">'+w+"</div>"};this.init=function(){s=e(t()).appendTo(v.dialog);e(".ui-colorpicker-ok",s).button().click(function(){v.close()});e(".ui-colorpicker-cancel",s).button().click(function(){v.color=v.currentColor.copy();v._change(v.color.set);v.close()});e(".ui-colorpicker-buttonset",s).buttonset();e(".ui-colorpicker-special-color",s).click(function(){v._change()});e("#"+r,s).click(function(){v._change(false)});e("#"+q,s).click(function(){v.color.setAlpha(0);v._change()})};this.repaint=function(){if(!v.color.set){e(".ui-colorpicker-special-none",s).attr("checked",true).button("refresh")}else{if(v.color.getAlpha()==0){e(".ui-colorpicker-special-transparent",s).attr("checked",true).button("refresh")}else{e("input",s).attr("checked",false).button("refresh")}}e(".ui-colorpicker-cancel",s).button(v.changed?"enable":"disable")};this.update=function(){}}},a=function(){var B={rgb:{r:0,g:0,b:0},hsv:{h:0,s:0,v:0},hsl:{h:0,s:0,l:0},lab:{l:0,a:0,b:0},cmyk:{c:0,m:0,y:0,k:1}},E=1,C=arguments,G=function(H){if(isNaN(H)||H===null){return 0}if(typeof H=="string"){H=parseInt(H,10)}return Math.max(0,Math.min(H,1))},x=function(K){var L="0123456789abcdef",J=K%16,I=(K-J)/16,H=L.charAt(I)+L.charAt(J);return H},v=function(I){var K=(I.r>0.04045)?Math.pow((I.r+0.055)/1.055,2.4):I.r/12.92,J=(I.g>0.04045)?Math.pow((I.g+0.055)/1.055,2.4):I.g/12.92,H=(I.b>0.04045)?Math.pow((I.b+0.055)/1.055,2.4):I.b/12.92;return{x:K*0.4124+J*0.3576+H*0.1805,y:K*0.2126+J*0.7152+H*0.0722,z:K*0.0193+J*0.1192+H*0.9505}},u=function(H){var I={r:H.x*3.2406+H.y*-1.5372+H.z*-0.4986,g:H.x*-0.9689+H.y*1.8758+H.z*0.0415,b:H.x*0.0557+H.y*-0.204+H.z*1.057};I.r=(I.r>0.0031308)?1.055*Math.pow(I.r,(1/2.4))-0.055:12.92*I.r;I.g=(I.g>0.0031308)?1.055*Math.pow(I.g,(1/2.4))-0.055:12.92*I.g;I.b=(I.b>0.0031308)?1.055*Math.pow(I.b,(1/2.4))-0.055:12.92*I.b;return I},r=function(J){var H=Math.min(J.r,J.g,J.b),O=Math.max(J.r,J.g,J.b),N=O-H,L,K,M,I={h:0,s:0,v:O};if(N===0){I.h=0;I.s=0}else{I.s=N/O;L=(((O-J.r)/6)+(N/2))/N;K=(((O-J.g)/6)+(N/2))/N;M=(((O-J.b)/6)+(N/2))/N;if(J.r===O){I.h=M-K}else{if(J.g===O){I.h=(1/3)+L-M}else{if(J.b===O){I.h=(2/3)+K-L}}}if(I.h<0){I.h+=1}else{if(I.h>1){I.h-=1}}}return I},D=function(N){var M={r:0,g:0,b:0},L,J,K,I,H;if(N.s===0){M.r=M.g=M.b=N.v}else{L=N.h===1?0:N.h*6;J=Math.floor(L);K=N.v*(1-N.s);I=N.v*(1-N.s*(L-J));H=N.v*(1-N.s*(1-(L-J)));if(J===0){M.r=N.v;M.g=H;M.b=K}else{if(J===1){M.r=I;M.g=N.v;M.b=K}else{if(J===2){M.r=K;M.g=N.v;M.b=H}else{if(J===3){M.r=K;M.g=I;M.b=N.v}else{if(J===4){M.r=H;M.g=K;M.b=N.v}else{M.r=N.v;M.g=K;M.b=I}}}}}}return M},y=function(J){var H=Math.min(J.r,J.g,J.b),O=Math.max(J.r,J.g,J.b),N=O-H,L,K,M,I={h:0,s:0,l:(O+H)/2};if(N===0){I.h=0;I.s=0}else{I.s=I.l<0.5?N/(O+H):N/(2-O-H);L=(((O-J.r)/6)+(N/2))/N;K=(((O-J.g)/6)+(N/2))/N;M=(((O-J.b)/6)+(N/2))/N;if(J.r===O){I.h=M-K}else{if(J.g===O){I.h=(1/3)+L-M}else{if(J.b===O){I.h=(2/3)+K-L}}}if(I.h<0){I.h+=1}else{if(I.h>1){I.h-=1}}}return I},A=function(J){var I,H,K=function(N,M,L){if(L<0){L+=1}if(L>1){L-=1}if((6*L)<1){return N+(M-N)*6*L}if((2*L)<1){return M}if((3*L)<2){return N+(M-N)*((2/3)-L)*6}return N};if(J.s===0){return{r:J.l,g:J.l,b:J.l}}H=(J.l<0.5)?J.l*(1+J.s):(J.l+J.s)-(J.s*J.l);I=2*J.l-H;return{r:K(I,H,J.h+(1/3)),g:K(I,H,J.h),b:K(I,H,J.h-(1/3))}},q=function(I){var H=I.x/0.95047,K=I.y,J=I.z/1.08883;H=(H>0.008856)?Math.pow(H,(1/3)):(7.787*H)+(16/116);K=(K>0.008856)?Math.pow(K,(1/3)):(7.787*K)+(16/116);J=(J>0.008856)?Math.pow(J,(1/3)):(7.787*J)+(16/116);return{l:((116*K)-16)/100,a:((500*(H-K))+128)/255,b:((200*(K-J))+128)/255}},w=function(I){var J={l:I.l*100,a:(I.a*255)-128,b:(I.b*255)-128},H={x:0,y:(J.l+16)/116,z:0};H.x=J.a/500+H.y;H.z=H.y-J.b/200;H.x=(Math.pow(H.x,3)>0.008856)?Math.pow(H.x,3):(H.x-16/116)/7.787;H.y=(Math.pow(H.y,3)>0.008856)?Math.pow(H.y,3):(H.y-16/116)/7.787;H.z=(Math.pow(H.z,3)>0.008856)?Math.pow(H.z,3):(H.z-16/116)/7.787;H.x*=0.95047;H.y*=1;H.z*=1.08883;return H},F=function(H){return{c:1-(H.r),m:1-(H.g),y:1-(H.b)}},z=function(H){return{r:1-(H.c),g:1-(H.m),b:1-(H.y)}},t=function(I){var H=1;if(I.c<H){H=I.c}if(I.m<H){H=I.m}if(I.y<H){H=I.y}if(H==1){return{c:0,m:0,y:0,k:1}}return{c:(I.c-H)/(1-H),m:(I.m-H)/(1-H),y:(I.y-H)/(1-H),k:H}},s=function(H){return{c:H.c*(1-H.k)+H.k,m:H.m*(1-H.k)+H.k,y:H.y*(1-H.k)+H.k}};this.set=true;this.setAlpha=function(H){if(H!==null){E=G(H)}return this};this.getAlpha=function(){return E};this.setRGB=function(J,I,H){B={rgb:this.getRGB()};if(J!==null){B.rgb.r=G(J)}if(I!==null){B.rgb.g=G(I)}if(H!==null){B.rgb.b=G(H)}return this};this.setHSV=function(J,I,H){B={hsv:this.getHSV()};if(J!==null){B.hsv.h=G(J)}if(I!==null){B.hsv.s=G(I)}if(H!==null){B.hsv.v=G(H)}return this};this.setHSL=function(J,I,H){B={hsl:this.getHSL()};if(J!==null){B.hsl.h=G(J)}if(I!==null){B.hsl.s=G(I)}if(H!==null){B.hsl.l=G(H)}return this};this.setLAB=function(J,I,H){B={lab:this.getLAB()};if(J!==null){B.lab.l=G(J)}if(I!==null){B.lab.a=G(I)}if(H!==null){B.lab.b=G(H)}return this};this.setCMYK=function(K,H,J,I){B={cmyk:this.getCMYK()};if(K!==null){B.cmyk.c=G(K)}if(H!==null){B.cmyk.m=G(H)}if(J!==null){B.cmyk.y=G(J)}if(I!==null){B.cmyk.k=G(I)}return this};this.getRGB=function(){if(!B.rgb){B.rgb=B.lab?u(w(B.lab)):B.hsv?D(B.hsv):B.hsl?A(B.hsl):B.cmyk?z(s(B.cmyk)):{r:0,g:0,b:0};B.rgb.r=G(B.rgb.r);B.rgb.g=G(B.rgb.g);B.rgb.b=G(B.rgb.b)}return e.extend({},B.rgb)};this.getHSV=function(){if(!B.hsv){B.hsv=B.lab?r(this.getRGB()):B.rgb?r(B.rgb):B.hsl?r(this.getRGB()):B.cmyk?r(this.getRGB()):{h:0,s:0,v:0};B.hsv.h=G(B.hsv.h);B.hsv.s=G(B.hsv.s);B.hsv.v=G(B.hsv.v)}return e.extend({},B.hsv)};this.getHSL=function(){if(!B.hsl){B.hsl=B.rgb?y(B.rgb):B.hsv?y(this.getRGB()):B.cmyk?y(this.getRGB()):B.hsv?y(this.getRGB()):{h:0,s:0,l:0};B.hsl.h=G(B.hsl.h);B.hsl.s=G(B.hsl.s);B.hsl.l=G(B.hsl.l)}return e.extend({},B.hsl)};this.getCMYK=function(){if(!B.cmyk){B.cmyk=B.rgb?t(F(B.rgb)):B.hsv?t(F(this.getRGB())):B.hsl?t(F(this.getRGB())):B.lab?t(F(this.getRGB())):{c:0,m:0,y:0,k:1};B.cmyk.c=G(B.cmyk.c);B.cmyk.m=G(B.cmyk.m);B.cmyk.y=G(B.cmyk.y);B.cmyk.k=G(B.cmyk.k)}return e.extend({},B.cmyk)};this.getLAB=function(){if(!B.lab){B.lab=B.rgb?q(v(B.rgb)):B.hsv?q(v(this.getRGB())):B.hsl?q(v(this.getRGB())):B.cmyk?q(v(this.getRGB())):{l:0,a:0,b:0};B.lab.l=G(B.lab.l);B.lab.a=G(B.lab.a);B.lab.b=G(B.lab.b)}return e.extend({},B.lab)};this.getChannels=function(){return{r:this.getRGB().r,g:this.getRGB().g,b:this.getRGB().b,a:this.getAlpha(),h:this.getHSV().h,s:this.getHSV().s,v:this.getHSV().v,c:this.getCMYK().c,m:this.getCMYK().m,y:this.getCMYK().y,k:this.getCMYK().k,L:this.getLAB().l,A:this.getLAB().a,B:this.getLAB().b}};this.getSpaces=function(){return e.extend(true,{},B)};this.setSpaces=function(H){B=H;return this};this.distance=function(K){var M="lab",I="get"+M.toUpperCase(),J=this[I](),H=K[I](),N=0,L;for(L in J){N+=Math.pow(J[L]-H[L],2)}return N};this.equals=function(J){var I=this.getRGB(),H=J.getRGB();return this.getAlpha()==J.getAlpha()&&I.r==H.r&&I.g==H.g&&I.b==H.b};this.limit=function(H){H-=1;var I=this.getRGB();this.setRGB(Math.round(I.r*H)/H,Math.round(I.g*H)/H,Math.round(I.b*H)/H)};this.toHex=function(){var H=this.getRGB();return x(H.r*255)+x(H.g*255)+x(H.b*255)};this.toCSS=function(){return"#"+this.toHex()};this.normalize=function(){this.setHSV(null,1,1);return this};this.copy=function(){var I=this.getSpaces(),H=this.getAlpha();return new a(I,H)};if(C.length==2){this.setSpaces(C[0]);this.setAlpha(C[1]===0?0:C[1]||1)}if(C.length>2){this.setRGB(C[0],C[1],C[2]);this.setAlpha(C[3]===0?0:C[3]||1)}};e.widget("vanderlee.colorpicker",{options:{alpha:false,altAlpha:true,altField:"",altOnChange:true,altProperties:"background-color",autoOpen:false,buttonColorize:false,buttonImage:"images/ui-colorpicker.png",buttonImageOnly:false,buttonText:null,closeOnEscape:true,closeOnOutside:true,color:"#00FF00",colorFormat:"HEX",draggable:true,duration:"fast",hsv:true,inline:true,layout:{map:[0,0,1,5],bar:[1,0,1,5],preview:[2,0,1,1],hsv:[2,1,1,1],rgb:[2,2,1,1],alpha:[2,3,1,1],hex:[2,4,1,1],lab:[3,1,1,1],cmyk:[3,2,1,2],swatches:[4,0,1,5]},limit:"",modal:false,mode:"h",parts:"",regional:"",rgb:true,showAnim:"fadeIn",showCancelButton:true,showNoneButton:false,showCloseButton:true,showOn:"focus",showOptions:{},swatches:null,title:null,close:null,init:null,select:null,open:null},_create:function(){var q=this,r;++p;q.widgetEventPrefix="color";q.opened=false;q.generated=false;q.inline=false;q.changed=false;q.dialog=null;q.button=null;q.image=null;q.overlay=null;q.mode=q.options.mode;if(q.options.swatches===null){q.options.swatches=h}if(this.element[0].nodeName.toLowerCase()==="input"||!q.options.inline){q._setColor(q.element.val());this._callback("init");e("body").append(f);q.dialog=e(".ui-colorpicker:last");e(document).mousedown(function(t){if(!q.opened||t.target===q.element[0]||q.overlay){return}if(q.dialog.is(t.target)||q.dialog.has(t.target).length>0){q.element.blur();return}var u,s=e(t.target).parents();for(u=0;u<=s.length;++u){if(q.button!==null&&s[u]===q.button[0]){return}}if(!q.options.closeOnOutside){return}q.close()});e(document).keydown(function(s){if(s.keyCode==27&&q.opened&&q.options.closeOnEscape){q.close()}});if(q.options.showOn==="focus"||q.options.showOn==="both"){q.element.on("focus click",function(){q.open()})}if(q.options.showOn==="button"||q.options.showOn==="both"){if(q.options.buttonImage!==""){r=q.options.buttonText||q._getRegional("button");q.image=e("<img/>").attr({src:q.options.buttonImage,alt:r,title:r});q._setImageBackground()}if(q.options.buttonImageOnly&&q.image){q.button=q.image}else{q.button=e('<button type="button"></button>').html(q.image||q.options.buttonText).button();q.image=q.image?e("img",q.button).first():null}q.button.insertAfter(q.element).click(function(){q[q.opened?"close":"open"]()})}if(q.options.autoOpen){q.open()}q.element.keydown(function(s){if(s.keyCode===9){q.close()}}).keyup(function(t){var s=c(q.element.val());if(!q.color.equals(s)){q.color=s;q._change()}})}else{q.inline=true;e(this.element).html(i);q.dialog=e(".ui-colorpicker",this.element);q._generate();q.opened=true}return this},_setOption:function(q,s){var r=this;switch(q){case"disabled":if(s){r.dialog.addClass("ui-colorpicker-disabled")}else{r.dialog.removeClass("ui-colorpicker-disabled")}break}e.Widget.prototype._setOption.apply(r,arguments)},_setImageBackground:function(){if(this.image&&this.options.buttonColorize){this.image.css("background-color",this.color.set?b("RGBA",this.color):"")}},_setAltField:function(){if(this.options.altOnChange&&this.options.altField&&this.options.altProperties){var q,s,r=this.options.altProperties.split(",");for(q=0;q<=r.length;++q){s=e.trim(r[q]);switch(s){case"color":case"background-color":case"outline-color":case"border-color":e(this.options.altField).css(s,this.color.set?this.color.toCSS():"");break}}if(this.options.altAlpha){e(this.options.altField).css("opacity",this.color.set?this.color.getAlpha():"")}}},_setColor:function(q){this.color=c(q);this.currentColor=this.color.copy();this._setImageBackground();this._setAltField()},setColor:function(q){this._setColor(q);this._change(this.color.set)},_generate:function(){var u=this,s,r,t,q;u._setColor(u.inline?u.options.color:u.element.val());if(typeof u.options.parts==="string"){if(l[u.options.parts]){t=l[u.options.parts]}else{t=l[u.inline?"inline":"popup"]}}else{t=u.options.parts}u.parts={};e.each(t,function(w,v){if(j[v]){u.parts[v]=new j[v](u)}});if(!u.generated){q=[];e.each(u.options.layout,function(v,w){if(u.parts[v]){q.push({part:v,pos:w})}});e(o(q,function(w,v,A){var z=["ui-colorpicker-"+w.part+"-container"];if(v>0){z.push("ui-colorpicker-padding-left")}if(A>0){z.push("ui-colorpicker-padding-top")}return'<td  class="'+z.join(" ")+'"'+(w.pos[2]>1?' colspan="'+w.pos[2]+'"':"")+(w.pos[3]>1?' rowspan="'+w.pos[3]+'"':"")+' valign="top"></td>'})).appendTo(u.dialog).addClass("ui-dialog-content ui-widget-content");u._initAllParts();u._updateAllParts();u.generated=true}},_effectGeneric:function(s,r,q,u,v){var t=this;if(e.effects&&e.effects[t.options.showAnim]){s[r](t.options.showAnim,t.options.showOptions,t.options.duration,v)}else{s[(t.options.showAnim==="slideDown"?q:(t.options.showAnim==="fadeIn"?u:r))]((t.options.showAnim?t.options.duration:null),v);if(!t.options.showAnim||!t.options.duration){v()}}},_effectShow:function(q,r){this._effectGeneric(q,"show","slideDown","fadeIn",r)},_effectHide:function(q,r){this._effectGeneric(q,"hide","slideUp","fadeOut",r)},open:function(){var t=this,s,q,z,A,r,w,v,u;if(!t.opened){t._generate();s=t.element.offset();q=e(window).height()+e(window).scrollTop();z=e(window).width()+e(window).scrollLeft();A=t.dialog.outerHeight();r=t.dialog.outerWidth();w=s.left;v=s.top+t.element.outerHeight();if(w+r>z){w=Math.max(0,z-r)}if(v+A>q){if(s.top-A>=e(window).scrollTop()){v=s.top-A}else{v=Math.max(0,q-A)}}t.dialog.css({left:w,top:v});u=0;e(t.element[0]).parents().each(function(){var x=e(this).css("z-index");if((typeof(x)==="number"||typeof(x)==="string")&&x!==""&&!isNaN(x)){u=x;return false}});t.dialog.css("z-index",u+=2);t.overlay=t.options.modal?new e.ui.dialog.overlay(t):null;t._effectShow(this.dialog);t.opened=true;t._callback("open",true);e(function(){t._repaintAllParts()})}},close:function(){var q=this;q.currentColor=q.color.copy();q.changed=false;q._effectHide(q.dialog,function(){q.dialog.empty();q.generated=false;q.opened=false;q._callback("close",true)});if(q.overlay){q.overlay.destroy()}},destroy:function(){this.element.unbind();if(this.image!==null){this.image.remove()}if(this.button!==null){this.button.remove()}if(this.dialog!==null){this.dialog.remove()}if(this.overlay){this.overlay.destroy()}},_callback:function(u,q){var s=this,t,r;if(s.color.set){t={formatted:b(s.options.colorFormat,s.color)};r=s.color.getLAB();r.a=(r.a*2)-1;r.b=(r.b*2)-1;if(q===true){t.a=s.color.getAlpha();t.rgb=s.color.getRGB();t.hsv=s.color.getHSV();t.cmyk=s.color.getCMYK();t.hsl=s.color.getHSL();t.lab=r}return s._trigger(u,null,t)}else{return s._trigger(u,null,{formatted:""})}},_initAllParts:function(){e.each(this.parts,function(r,q){if(q.init){q.init()}})},_updateAllParts:function(){e.each(this.parts,function(r,q){if(q.update){q.update()}})},_repaintAllParts:function(){e.each(this.parts,function(r,q){if(q.repaint){q.repaint()}})},_change:function(r){this.color.set=(r!==false);this.changed=true;switch(this.options.limit){case"websafe":this.color.limit(6);break;case"nibble":this.color.limit(16);break;case"binary":this.color.limit(2);break;case"name":var q=d(this.color);this.color.setRGB(h[q].r,h[q].g,h[q].b);break}if(!this.inline){if(!this.color.set){this.element.val("")}else{if(!this.color.equals(c(this.element.val()))){this.element.val(b(this.options.colorFormat,this.color))}}this._setImageBackground();this._setAltField()}if(this.opened){this._repaintAllParts()}this._callback("select")},_hoverable:function(q){q.hover(function(){q.addClass("ui-state-hover")},function(){q.removeClass("ui-state-hover")})},_focusable:function(q){q.focus(function(){q.addClass("ui-state-focus")}).blur(function(){q.removeClass("ui-state-focus")})},_getRegional:function(q){return e.colorpicker.regional[this.options.regional][q]!==undefined?e.colorpicker.regional[this.options.regional][q]:e.colorpicker.regional[""][q]}})}(jQuery));